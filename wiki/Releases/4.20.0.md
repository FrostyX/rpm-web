---
layout: default
title: rpm.org - Releases
---

# RPM 4.20.0 Release Notes (DRAFT)

Last update: 2024-04-05

## Download
* Source: [rpm-4.19.90.tar.bz2](https://ftp.osuosl.org/pub/rpm/releases/testing/rpm-4.19.90.tar.bz2)
* SHA256SUM: 93b442e5632d67eff0cd957649e9436b864f61dbe5a0c7c99954fcf14937302c

## Highlights
* [Declarative buildsystem](https://rpm-software-management.github.io/rpm/manual/buildsystem.html) support ([#2774](https://github.com/rpm-software-management/rpm/pull/2774))
* A new RPM-controlled per-build directory ([#2885](https://github.com/rpm-software-management/rpm/pull/2885))
* Support for [SPEC-local](https://rpm-software-management.github.io/rpm/manual/dependency_generators.html#using-file-attributes-in-their-own-package) file attributes and generators ([#2911](https://github.com/rpm-software-management/rpm/pull/2911))
* New prepend and append [modes](https://rpm-software-management.github.io/rpm/manual/spec.html#build-scriptlets) for build scriptlets ([#2728](https://github.com/rpm-software-management/rpm/pull/2728))
* Python bindings have been ported to the stable ABI ([#2674](https://github.com/rpm-software-management/rpm/pull/2674))
* Plugin API is now public ([#2661](https://github.com/rpm-software-management/rpm/pull/2661))
* Increased isolation of install scriptlets on Linux via a new plugin ([#2666](https://github.com/rpm-software-management/rpm/pull/2666))
* File trigger scripts now also receive package count arguments ([#2871](https://github.com/rpm-software-management/rpm/pull/2871), [#2883](https://github.com/rpm-software-management/rpm/pull/2883))
* Perl dependency generators have been split out ([#2947](https://github.com/rpm-software-management/rpm/pull/2947))
* Internal OpenPGP parser has been removed ([#2986](https://github.com/rpm-software-management/rpm/pull/2986), [#2984](https://github.com/rpm-software-management/rpm/pull/2984))

## Changelog
### Enhancements
* Command line: Add `--list` and `--delete` commands to rpmkeys ([#2921](https://github.com/rpm-software-management/rpm/pull/2921))
* Command line: Implement `--json` query format ([#2913](https://github.com/rpm-software-management/rpm/pull/2913))
* Transaction: Pass arg1 to file trigger scripts ([#2871](https://github.com/rpm-software-management/rpm/pull/2871))
* Transaction: Pass arg2 to file trigger scripts ([#2883](https://github.com/rpm-software-management/rpm/pull/2883))
* Packaging: Add build directory auto path to `%autosetup` step ([#2859](https://github.com/rpm-software-management/rpm/pull/2859))
* Packaging: Add support for declarative buildsystem ([#2774](https://github.com/rpm-software-management/rpm/pull/2774))
* Packaging: Add support for spec local file attributes and generators ([#2911](https://github.com/rpm-software-management/rpm/pull/2911))
* Packaging: Add support for sysusers group membership lines ([#2990](https://github.com/rpm-software-management/rpm/pull/2990))
* Packaging: Allow to specify a default for bcond features in a macro file ([#2405](https://github.com/rpm-software-management/rpm/pull/2405))
* Packaging: Expose build time to package build scriptlets via `$RPM_BUILD_TIME` ([#2933](https://github.com/rpm-software-management/rpm/pull/2933))
* Packaging: Implement prepend and append modes for all our normal build scriptlets ([#2728](https://github.com/rpm-software-management/rpm/pull/2728))
* Packaging: Introduce an rpm-controlled per-build directory ([#2885](https://github.com/rpm-software-management/rpm/pull/2885))
* Macros: Speed up line macro line number tracking [Optimization] ([#2746](https://github.com/rpm-software-management/rpm/pull/2746))
* Macros: Support per-user macro configuration in `XDG_CONFIG_HOME` ([#2992](https://github.com/rpm-software-management/rpm/pull/2992))
* Generators: Support generating dependencies for multiple files at once ([#2537](https://github.com/rpm-software-management/rpm/pull/2537))
* Python bindings: Use Python Stable ABI for the bindings ([#2674](https://github.com/rpm-software-management/rpm/pull/2674))
* Build: Allow building rpm without OpenPGP support ([#2984](https://github.com/rpm-software-management/rpm/pull/2984))
* Build: CMakeLists.txt: eliminate floating dependencies ([#2914](https://github.com/rpm-software-management/rpm/pull/2914))
* Build: Make our plugin directory a global cache configurable and export it ([#2688](https://github.com/rpm-software-management/rpm/pull/2688))
* Plugins: Add a new plugin to enable Linux-specific namespace functionality ([#2666](https://github.com/rpm-software-management/rpm/pull/2666))
* Plugins: Make the plugin API public ([#2661](https://github.com/rpm-software-management/rpm/pull/2661))

### Changes
* Packaging: Reword "`%changelog` is missing" warning [Cosmetic] ([#2943](https://github.com/rpm-software-management/rpm/pull/2943))
* Packaging: Allow whitespace before directives in the Preamble ([#2957](https://github.com/rpm-software-management/rpm/pull/2957))
* Packaging: Convert `%prep` into a regular build scriptlet ([#2730](https://github.com/rpm-software-management/rpm/pull/2730))
* Packaging: Don't brp-strip ruby, python, or javascript files ([#2858](https://github.com/rpm-software-management/rpm/pull/2858))
* Generators: Remove perl dependency generators from the repo ([#2947](https://github.com/rpm-software-management/rpm/pull/2947))

### Deprecations
* Split the internal OpenPGP parser to a separate repository ([#2986](https://github.com/rpm-software-management/rpm/pull/2986))

### Fixes
* Command line: Set the charset of the libarchive strings to utf8 ([#2993](https://github.com/rpm-software-management/rpm/pull/2993))
* Command line: rpm2archive: fix hardlink handling in cpio output ([#2975](https://github.com/rpm-software-management/rpm/pull/2975))
* Transaction: Ignore `%config` flag where not supported ([#2906](https://github.com/rpm-software-management/rpm/pull/2906))
* Transaction: Ignore non-scriptlet weak dependencies in ordering ([#3004](https://github.com/rpm-software-management/rpm/pull/3004))
* Packaging: Ensure binary and source headers are identified as such after parse [Regression] ([#3012](https://github.com/rpm-software-management/rpm/pull/3012))
* Packaging: Never use current user info or file ownership during build [Regression] ([#2797](https://github.com/rpm-software-management/rpm/pull/2797))
* Packaging: Ensure rpmbuild's cleanup doesn't fail due to permissions ([#3006](https://github.com/rpm-software-management/rpm/pull/3006))
* Packaging: Let eBPF ELF files be packaged in noarch packages ([#2902](https://github.com/rpm-software-management/rpm/pull/2902))
* Packaging: Really allow qualifiers like pre/post/meta for weak dependencies ([#2964](https://github.com/rpm-software-management/rpm/pull/2964))
* Packaging: Run build scriptlets with closed stdin to enforce unattended builds ([#2898](https://github.com/rpm-software-management/rpm/pull/2898))
* Packaging: Set git commit dates based on `$SOURCE_DATE_EPOCH` ([#2930](https://github.com/rpm-software-management/rpm/pull/2930))
* Macros: Issue a warning when passing arguments to non-parametric macros [Cosmetic] ([#2940](https://github.com/rpm-software-management/rpm/pull/2940))
* Macros: Make `%dirname` and `%basename` behave like `dirname(3)` and `basename(3)` ([#2945](https://github.com/rpm-software-management/rpm/pull/2945))
* Macros: Strip quote characters in macro expansion if we do not split the result ([#2788](https://github.com/rpm-software-management/rpm/pull/2788))
* Generators: Fix dependency generators sometimes dying with `SIGPIPE` [Regression] ([#2958](https://github.com/rpm-software-management/rpm/pull/2958))
* Python bindings: Return false when comparing different python objects holding the same version tag ([#2838](https://github.com/rpm-software-management/rpm/pull/2838))
* Python bindings: Support rpmver-py comparison operator inheritance ([#2839](https://github.com/rpm-software-management/rpm/pull/2839))

### Security
* Build: Allow building rpm without OpenPGP support ([#2984](https://github.com/rpm-software-management/rpm/pull/2984))
* Move OpenSSL code to newer API ([#2723](https://github.com/rpm-software-management/rpm/pull/2723))
* Split the internal OpenPGP parser to a separate repository ([#2986](https://github.com/rpm-software-management/rpm/pull/2986))

## Compatibility notes
* The `%patchN` macro syntax (where `N` is a patch number) is now obsolete and
  will produce a build error.  Use `%patch N` (or `%patch -P N`) instead.
* The `rpm2cpio(8)` utility has been [removed](https://github.com/rpm-software-management/rpm/pull/2758) in favor of `rpm2archive(8)`.
* Python 3.7 and OpenSSL 3.0 are now the minimum build requirements.
